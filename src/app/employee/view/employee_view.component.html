<ngx-spinner bdColor = "rgba(0, 0, 0, 0.8)" size = "medium" color = "#fff" type = "timer" [fullScreen] = "true"><p style="color: white" > Loading... </p></ngx-spinner>
<div class="page-breadcrumb">
    <div class="row">
        <div class="col-5 align-self-center">
            <h4 class="page-title">ข้อมูลพนักงาน</h4>
            <div class="d-flex align-items-center">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="#">Dashboard</a></li>
                        <li class="breadcrumb-item active" aria-current="page">ข้อมูลพนักงาน</li>
                    </ol>
                </nav>
            </div>
        </div>
    </div>
  </div>
  <br />
  <div class="container-fluid">
      <div class="row">
          <div class="col-12">
              <div class="card">
                  <div class="card-header card-header-cover-table">
                      <div class="row">
                          <div class="col-9">
                              ข้อมูลพนักงาน
                          </div>
                          <div class="col-3">
                               
                          </div>
                      </div>
                  </div>
                  <div class="card-body">
                    <form id="edit-form">
                    <fieldset class="border p-2">
                    <legend class="w-auto legend-header" style="text-align: left;color: #1ab196;"> ข้อมูลส่วนตัว</legend>
                    <div class="row">
                        <div class="col-6">
                            <div style="text-align: center;" class="m-t-30"> <img src="{{urlProfile}}" class="rounded-circle" width="220" />
                                
                            </div >
                        </div>
                        <div class="col-6">
                            <div style="float: right;" *ngIf="!isGuard">
                            <button type="button" class="btn btn-rounded btn-info" 
                            (click)="openModalExportFile()"><i class="fas fa-file-pdf"></i> Export</button>&nbsp;
                            <button type="button" class="btn btn-rounded btn-warning" 
                                (click)="openModelexportDocument()"><i class="fas fa-file-pdf"></i> นำส่งเอกสาร</button>&nbsp;
                            <button type="button" class="btn btn-rounded btn-success" 
                                (click)="openModelMergeDocument()"><i class="fas fa-file-pdf"></i> รวมเอกสาร</button>&nbsp;
                            <button type="button" class="btn btn-rounded btn-dark" 
                                (click)="exportInspection()"><i class="fas fa-file-pdf"></i> ใบประเมิน</button>&nbsp;
                            <button type="button" class="btn btn-rounded btn-info" 
                                (click)="exportContractAudit()"><i class="fas fa-file-pdf"></i> สัญญา (Audit)</button>&nbsp;
                            <button type="button" class="btn btn-rounded btn-info" 
                                (click)="openModalExportEmployeeCard()"><i class="fas fa-file-pdf"></i> โหลดบัตรพนักงาน</button>&nbsp;
                            <button type="button" class="btn btn-rounded btn-info" 
                                (click)="openModalExportPermitCard()"><i class="fas fa-file-pdf"></i> โหลดบัตรธภ.7</button>
                            </div>
                        </div>
                    </div> 
                    <div class="row">
                          <div class="col-sm-12 col-md-2">
                            <label class="control-label txt-title">คำนำหน้าชื่อ </label>
                            <div class="form-group txt-detail">
                                {{employee?.prefix}}
                            </div>
                          </div>
                          <div class="col-sm-12 col-md-2">
                            <label class="control-label txt-title">ชื่อเล่น </label>
                            <div class="form-group txt-detail">
                                {{employee?.nick_name}}
                            </div>
                          </div>
                          <div class="col-sm-12 col-md-4">
                            <label class="control-label txt-title">ชื่อ </label>
                            <div class="form-group txt-detail">
                                {{employee?.first_name}}
                            </div>
                          </div>
                          <div class="col-sm-12 col-md-4">
                            <label class="control-label txt-title">นามสกุล </label>
                            <div class="form-group txt-detail">
                                {{employee?.last_name}}
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-12 col-md-2">
                            <label class="control-label txt-title">เพศ </label>
                            <div class="form-group txt-detail">
                                <span *ngIf="employee?.gender == 'N'">ไม่ระบุ</span>
                                <span *ngIf="employee?.gender == 'M'">ชาย</span>
                                <span *ngIf="employee?.gender == 'F'">หญิง</span>
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-2">
                            <label class="control-label txt-title">วันเกิด </label>
                            <div class="form-group txt-detail">
                                {{employee?.date_of_birth}}<br />
                                <span style="font-weight: bold;color:green">อายุ: </span>{{employee?.age_th}}
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-4">
                            <label class="control-label txt-title">บัตรประชาชน </label>
                            <div class="form-group txt-detail">
                                {{employee?.identity_no}}
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-4">
                            <label class="control-label txt-title">บัตรหมดอายุ </label>
                            <div class="form-group txt-detail">
                                {{employee?.expired_card}}
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-12 col-md-4">
                            <label class="control-label txt-title">เชื้อชาติ </label>
                            <div class="form-group txt-detail">
                                {{employee?.ethnicity}}
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-4">
                            <label class="control-label txt-title">สัญชาติ </label>
                            <div class="form-group txt-detail">
                                {{employee?.nationality}}
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-4">
                            <label class="control-label txt-title">ศาสนา </label>
                            <div class="form-group txt-detail">
                                {{employee?.religion}}
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-12 col-md-4">
                            <label class="control-label txt-title">เบอร์โทรศัพท์ </label>
                            <div class="form-group txt-detail">
                                {{employee?.mobile}}
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-4">
                            <label class="control-label txt-title">บุคคลอ้างอิง (ชื่อ-นามสกุล,ความสัมพันธ์,เบอร์โทรศัพท์) </label>
                            <div class="form-group txt-detail">
                                {{employee?.personnel_ref}}
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-4">
                            <label class="control-label txt-title">อีเมล์ </label>
                            <div class="form-group txt-detail">
                                {{employee?.email}}
                            </div>
                        </div> 
                    </div>
                    <div class="row">
                        <div class="col-sm-12 col-md-4">
                            <label class="control-label txt-title">เลขที่บัญชีธนาคาร </label>
                            <div class="form-group txt-detail">
                                {{employee?.bank_account_no}}
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-4">
                            <label class="control-label txt-title">น้ำหนัก </label>
                            <div class="form-group txt-detail">
                                {{employee?.weight}}
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-4">
                            <label class="control-label txt-title">ส่วนสูง </label>
                            <div class="form-group txt-detail">
                                {{employee?.height}}
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-12 col-md-4">
                            <label class="control-label txt-title">สถานภาพ </label>
                            <div class="form-group txt-detail">
                                <span *ngIf="employee?.marital_status == 'N'">ไม่ระบุ</span>
                                <span *ngIf="employee?.marital_status == 'M'">แต่งงานแล้ว</span>
                                <span *ngIf="employee?.marital_status == 'S'">โสด</span>
                            </div>
                        </div>
                    </div>
                    </fieldset>
                    <fieldset class="border p-2">
                    <legend  class="w-auto legend-header" style="text-align: left;color: #1ab196;"> ข้อมูลที่อยู่</legend>
                    <div class="row">
                        <div class="col-sm-12 col-md-4">
                            <label class="control-label txt-title">ที่อยู่ </label>
                            <div class="form-group txt-detail">
                                {{employee?.detail}}
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-4">
                            <label class="control-label txt-title">ลักษณะที่อยู่ </label>
                            <div class="form-group txt-detail">
                                {{employee?.address_type}}
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-4">
                            <label class="control-label txt-title">จังหวัด </label>
                            <div class="form-group txt-detail">
                                {{employee?.province}}
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-12 col-md-4">
                            <label class="control-label txt-title">อำเภอ </label>
                            <div class="form-group txt-detail">
                                {{employee?.district}}
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-4">
                            <label class="control-label txt-title">ตำบล </label>
                            <div class="form-group txt-detail">
                                {{employee?.subdistrict}}
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-4">
                            <label class="control-label txt-title">รหัสไปรษณีย์ </label>
                            <div class="form-group txt-detail">
                                {{employee?.postcode}}
                            </div>
                        </div>
                    </div>
                    </fieldset>
                    <fieldset class="border p-2">
                    <legend  class="w-auto legend-header" style="text-align: left;color: #1ab196;"> ข้อมูลอื่นๆ</legend>
                    <div class="row">
                        <div class="col-sm-12 col-md-4">
                            <label class="control-label txt-title">บริษัท </label>
                            <div class="form-group txt-detail">
                                {{employee?.companyName}}
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-4">
                            <label class="control-label txt-title">แผนกงาน </label>
                            <div class="form-group txt-detail">
                                {{employee?.departmentName}}
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-4">
                            <label class="control-label txt-title">ตำแหน่ง </label>
                            <div class="form-group txt-detail">
                                {{employee?.positionName}}
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-12 col-md-4">
                            <label class="control-label txt-title">ภาวะทางทหาร </label>
                            <div class="form-group txt-detail">
                                {{employee?.military_condition}}
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-4">
                            <label class="control-label txt-title">ระดับการศึกษา </label>
                            <div class="form-group txt-detail">
                                {{employee?.education_level}}
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-12 col-md-4">
                            <label class="control-label txt-title">โรงพยาบาล1 </label>
                            <div class="form-group txt-detail">
                                {{employee?.hospital1}}
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-4">
                            <label class="control-label txt-title">จบลงหน่วยงาน </label>
                            <div class="form-group txt-detail">
                                {{employee?.end_agency}}
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-2">
                            <label class="control-label txt-title">วันที่จบการอบรม </label>
                            <div class="form-group txt-detail">
                                {{employee?.start_work}}
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-2">
                            <label class="control-label txt-title">วันที่ออกจากงาน </label>
                            <div class="form-group txt-detail">
                                {{employee?.leave_work}}
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-12 col-md-4">
                        </div>
                        <div class="col-sm-12 col-md-4">
                            <label class="control-label txt-title">ใบอนุญาตเลขที่ </label>
                            <div class="form-group txt-detail">
                                {{employee?.permit_card_no}}
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-2">
                            <label class="control-label txt-title">วันออกบัตรอนุญาต </label>
                            <div class="form-group txt-detail">
                                {{employee?.permit_card_start_date}}
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-2">
                            <label class="control-label txt-title">วันสิ้นอายุบัตรอนุญาต </label>
                            <div class="form-group txt-detail">
                                {{employee?.permit_card_end_date}}
                            </div>
                        </div>
                    </div>
                    </fieldset>
                    <fieldset class="border p-2">
                        <legend  class="w-auto legend-header" style="text-align: left;color: #1ab196;font-weight: bold;"> ข้อมูลผู้แนะนำ</legend>
                        <div *ngIf="recommender" class="row">
                            <div class="col-sm-12 col-md-3">
                                <label class="control-label txt-title">ชื่อ-นามสกุล : </label> {{recommender.prefix}}{{recommender.first_name}} {{recommender.last_name}}
                            </div>
                            <div class="col-sm-12 col-md-2">
                                <label class="control-label txt-title">เลขบัตรประชาชน : </label> {{recommender.identity_no}}
                            </div>
                            <div class="col-sm-12 col-md-2">
                                <label class="control-label txt-title">เบอร์โทรศัพท์ : </label> {{recommender.mobile}}
                            </div>
                            <div class="col-sm-12 col-md-5">
                                <label class="control-label txt-title">ที่อยู่ : </label> {{recommender.address_detail}}
                            </div>
                        </div>
                    </fieldset>
                    <fieldset class="border p-2">
                        <legend  class="w-auto legend-header" style="text-align: left;color: #1ab196;font-weight: bold;"> ค่าขึ้นทะเบียน</legend>
                        <div class="row">
                            <div class="col-sm-12 col-md-3">
                                <label class="control-label txt-title">จำนวนเงิน : </label> {{employee?.registration_amount | number : '1.2-2'}} บาท
                            </div>
                            <div class="col-sm-12 col-md-3">
                                <label class="control-label txt-title">จำนวนงวดแบ่งจ่าย : </label> {{employee?.registration_ins_paid}} งวด
                            </div>
                            <div class="col-sm-12 col-md-3">
                                <label class="control-label txt-title">งวดละ : </label> {{employee?.registration_per_paid | number : '1.2-2'}} บาท
                            </div>
                            <div class="col-sm-12 col-md-3">
                                <label class="control-label txt-title">เริ่มจ่าย : </label> {{employee?.registration_start_paid_date}}
                            </div>
                        </div>
                    </fieldset>
                    <fieldset class="border p-2">
                        <legend  class="w-auto legend-header" style="text-align: left;color: #1ab196;font-weight: bold;"> ค่าชุดอุปกรณ์</legend>
                        <div class="row" *ngFor="let item of costEquipmentList; index as i">
                            <div class="col-sm-12 col-md-6">
                                <label class="control-label txt-title">รายละเอียด : </label> {{item.detail}}
                            </div>
                            <div class="col-sm-12 col-md-2">
                                <label class="control-label txt-title">ราคา : </label> {{item.price}}
                            </div>
                        </div>
                    </fieldset>
                    </form>
                  </div>
              </div>
          </div>
      </div>
  </div>

<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header card-header-cover-table">
                    <div class="row">
                        <div class="col-9">
                            ตารางการปฏิบัติงาน
                        </div>
                        <div class="col-3">

                        </div>
                    </div>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="card col-sm-12 col-md-12">
                            <form [formGroup]="searchForm" id="add-form">
                                <div class="row">
                                    <div class="col-sm-12 col-md-2">
                                        <div class="form-group m-b-30">
                                            <label for="holiday-year-search">เดือน</label>
                                            <select class="form-control" formControlName="month">
                                                <option value="1-0">มกราคม (1-15)</option>
                                                <option value="1-1">มกราคม (16-31)</option>
                                                <option value="2-0">กุมภาพันธ์ (1-15)</option>
                                                <option value="2-1">กุมภาพันธ์ (16-29)</option>
                                                <option value="3-0">มีนาคม (1-15)</option>
                                                <option value="3-1">มีนาคม (16-31)</option>
                                                <option value="4-0">เมษายน (1-15)</option>
                                                <option value="4-1">เมษายน (16-30)</option>
                                                <option value="5-0">พฤษภาคม (1-15)</option>
                                                <option value="5-1">พฤษภาคม (16-31)</option>
                                                <option value="6-0">มิถุนายน (1-15)</option>
                                                <option value="6-1">มิถุนายน (16-30)</option>
                                                <option value="7-0">กรกฎาคม (1-15)</option>
                                                <option value="7-1">กรกฎาคม (16-31)</option>
                                                <option value="8-0">สิงหาคม (1-15)</option>
                                                <option value="8-1">สิงหาคม (16-31)</option>
                                                <option value="9-0">กันยายน (1-15)</option>
                                                <option value="9-1">กันยายน (16-30)</option>
                                                <option value="10-0">ตุลาคม (1-15)</option>
                                                <option value="10-1">ตุลาคม (16-31)</option>
                                                <option value="11-0">พฤศจิกายน (1-15)</option>
                                                <option value="11-1">พฤศจิกายน (16-30)</option>
                                                <option value="12-0">ธันวาคม (1-15)</option>
                                                <option value="12-1">ธันวาคม (16-31)</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-sm-12 col-md-2">
                                        <div class="form-group m-b-30">
                                            <label for="holiday-year-search">ปี พ.ศ.</label>
                                            <select class="form-control" formControlName="year">
                                                <option *ngFor="let item of yearList" value="{{item?.enYear}}">{{item?.thYear}}
                                                </option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-sm-12 col-md-2">
                                        <div class="form-group m-b-30">
                                            <button type="button" class="btn btn-rounded btn-info" style="margin-top: 15%;" (click)="searchCheckPoint(searchForm.value)"><i class="fa fa-search"></i> ค้นหา</button>
                                        </div>
                                    </div> 
                                </div>
                            </form>
                        </div>
                    </div>
                    <br />

                    <div class="row">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-body" style="padding:0px !important">
                                    <table class="table table-striped table-bordered">
                                        <thead style="background: #54a0ff;">
                                            <tr>
                                                <th class="tb-main-col-checkpoint" style="font-weight: bold;">หน่วยงาน/พนักงาน</th>
                                                <ng-container *ngFor="let item of dayList;let i = index">
                                                    <th class="tb-main-col-checkpoint" style="font-weight: bold;">{{item}}</th>
                                                </ng-container>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <ng-container *ngFor="let item of checkPointRecheck;let i = index">
                                                <tr>
                                                    <td style="font-weight: bold;background: #cadef8;">
                                                        {{item.prefix}}{{item.first_name}} {{item.last_name}}
                                                    </td>
                                                    <ng-container *ngFor="let dayEmpItem of dayList;let countDayEmpItem = index">
                                                        <td style="background: #cadef8;">
                                                            {{dayEmpItem}}
                                                        </td>
                                                    </ng-container>
                                                </tr>
                                                <ng-container *ngFor="let customerWork of item.customerWorkList;let countCustomerWork = index">
                                                    <tr style="background: #c7dce7;">
                                                        <td style="background-color: #ffffff;">
                                                            {{customerWork.customerName}}
                                                        </td>
                                                        <ng-container *ngFor="let workItem of customerWork.workList;let countWorkItem = index">
                                                            <td 
                                                            [ngClass]="{
                                                                'status-blue' : workItem.status=='SL',
                                                                'status-grey' : workItem.status=='L' || workItem.status=='S' || workItem.status=='OF' || workItem.status=='M',
                                                                'status-green' : workItem.status=='AL' || workItem.status=='ALW' || workItem.status=='H',
                                                                'status-dark-blue' : ((workItem.status=='W' && workItem.day) || (workItem.status=='A' && workItem.day) || (workItem.status=='AA' && workItem.day) || (workItem.status=='HE' && workItem.day) 
                                                                || (workItem.status=='AAD' && workItem.day) || (workItem.status=='AAN' && workItem.day) || (workItem.status=='AADN' && workItem.day)),
                                                                'status-red' : ((workItem.status=='W' && workItem.nigth) || (workItem.status=='A' && workItem.nigth)|| (workItem.status=='AA' && workItem.nigth) || (workItem.status=='HE' && workItem.nigth) 
                                                                || (workItem.status=='AAD' && workItem.nigth) || (workItem.status=='AAN' && workItem.nigth) || (workItem.status=='AADN' && workItem.nigth)),
                                                                'bg-workdn' : ((workItem.status=='W' && workItem.day && workItem.nigth) || (workItem.status=='A' && workItem.day && workItem.nigth) || (workItem.status=='AA' && workItem.day && workItem.nigth) || (workItem.status=='HE' && workItem.day && workItem.nigth) 
                                                                || (workItem.status=='AADN' && workItem.day && workItem.nigth) || (workItem.status=='AAD' && workItem.day && workItem.nigth) || (workItem.status=='AAN' && workItem.day && workItem.nigth)),
                                                                'status-past-time' : workItem.status=='PA',
                                                                'status-not-work' : (workItem.status==''||workItem.status==null) || (workItem.status=='W' && !workItem.day && !workItem.nigth)
                                                                }">
                                                                <span *ngIf="workItem.status=='W' && workItem.day">ทำงาน(D)<br /></span>
                                                                <span *ngIf="workItem.status=='W' && workItem.nigth">ทำงาน(N)</span>
                                                                <span *ngIf="workItem.status=='HE' && workItem.day">ช่วย(D)<br /></span>
                                                                <span *ngIf="workItem.status=='HE' && workItem.nigth">ช่วย(N)</span>
                                                                <span *ngIf="workItem.status=='A' && workItem.day">เสริม(D)<br /></span>
                                                                <span *ngIf="workItem.status=='A' && workItem.nigth">เสริม(N)</span>
                                                                <span *ngIf="workItem.status=='AA' && workItem.day">ควง(D)<br /></span>
                                                                <span *ngIf="workItem.status=='AA' && workItem.nigth">ควง(N)</span>
                                                                <span *ngIf="workItem.status=='AAD'">ควง(จ่ายสด D)</span>
                                                                <span *ngIf="workItem.status=='AAN'">ควง(จ่ายสด N)</span>
                                                                <span *ngIf="workItem.status=='AADN'">ควง(จ่ายสด DN)</span>
                                                                <span *ngIf="workItem.status=='PA'">พาร์สทาม</span>
                                                                <span *ngIf="workItem.status=='H'">นักขัตฤกษ์</span>
                                                                <span *ngIf="workItem.status=='S'">อาทิตย์<br />(จ่ายสด)</span>
                                                                <span *ngIf="workItem.status=='SL'">ลาป่วย</span>
                                                                <span *ngIf="workItem.status=='AL'">ลาพักร้อน</span>
                                                                <span *ngIf="workItem.status=='ALW'">ลาพักร้อนทำงาน</span>
                                                                <span *ngIf="workItem.status=='L'">ลากิจ</span>
                                                                <span *ngIf="workItem.status=='OF'">OFF</span>
                                                                <span *ngIf="workItem.status=='M'">ขาด</span>
                                                            </td>
                                                        </ng-container>
                                                    </tr>
                                                </ng-container>
                                            </ng-container>
                                        </tbody>
                                    </table>
                                </div>
                            </div> 
                        </div>
                    </div>
                    
                </div>
            </div>
        </div>
    </div>
</div>

  <div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header card-header-cover-table">
                    <div class="row">
                        <div class="col-9">
                            หมายเหตุเพิ่มเติม
                        </div>
                        <div class="col-3">
                             
                        </div>
                    </div>
                </div>
                <div class="card-body"> 
                <div class="row">
                    <div class="card col-sm-12 col-md-12">
                        <div class="card-header">รายการหมายเหตุเพิ่มเติม</div>
                        <div class="table-responsive">
                            <table id="company_table" class="table table-striped table-bordered">
                                <thead>
                                    <tr>
                                        <th style="width: 10%;" class="center">ลำดับ</th>
                                        <th style="width: 70%;">รายละเอียดหมายเหตุ</th>
                                        <th style="width: 20%;">วันที่บันทึก</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr *ngFor="let item of remarkList; index as i">
                                        <td style="width: 10%;" class="center">{{i+1}}</td>
                                        <td style="width: 70%;" class="left">{{item.description}}</td>
                                        <td style="width: 20%;" class="left">
                                            {{item.created_at | date: 'dd/MM/yyyy HH:mm:ss'}}
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header card-header-cover-table">
                    <div class="row">
                        <div class="col-9">
                            ประวัติด้านไม่ดี
                        </div>
                        <div class="col-3">
                             
                        </div>
                    </div>
                </div>
                <div class="card-body">

                  <div class="row">
                    <div class="col-12">
                        <div class="table-responsive">
                            <table id="company_table" class="table table-striped table-bordered">
                                <thead>
                                    <tr>
                                        <th style="width: 10%;" class="center">ลำดับ</th>
                                        <th style="width: 30%;">รายละเอียดประวัติด้านไม่ดี</th>
                                        <th style="width: 50%;">รายการไฟล์หลักฐาน</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr *ngFor="let item of badHistoryList; index as i">
                                        <td style="width: 10%;" class="center">{{i+1}}</td>
                                        <td style="width: 30%;" class="left">
                                            <textarea rows="3" class="form-control" placeholder="รายละเอียดประวัติด้านไม่ดี" [(ngModel)]="item.description" disabled></textarea>
                                        </td>
                                        <td style="width: 50%;" class="left">
                                            <ul>
                                                <li *ngFor="let item of item.fileInfoMap | keyvalue; index as i">
                                                    <a target="_blank" href="{{ item.value.url }}">{{item.value.name_origin}}</a>
                                                </li>
                                            </ul>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                  </div>
                </div>
            </div>
        </div>
    </div>
</div>


  <div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header card-header-cover-table">
                    <div class="row">
                        <div class="col-9">
                            ข้อมูลเอกสาร
                        </div>
                        <div class="col-3">
                             
                        </div>
                    </div>
                </div>
                <div class="card-body">
                  <div class="row">
                      <div class="panel-group col-sm-12 col-md-12">
                            
                              <div class="form-group">
                                  <div class="input-group">
                                    <div class="card col-sm-12 col-md-12">
                                        <div class="card-header">รายการเอกสาร</div>
                                        <div class="table-responsive">
                                            <table class="table">
                                                <thead>
                                                    <tr>
                                                        <th style="width: 10%;" class="center">ลำดับ</th>
                                                        <th style="width: 40%;">ชื่อไฟล์</th>
                                                        <th style="width: 10%;">เอกสารเข้างานรอบที่</th>
                                                        <th style="width: 10%;">วันที่อัพโหลดไฟล์</th>
                                                        <th style="width: 10%;"></th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr *ngFor="let item of fileInfoMap | keyvalue: descOrder; index as i" [ngClass]="{ 'bg-init': item.value.index == 0 , 'bg-palegoldenrod': item.value.index % 2 == 0 }" >
                                                        <td style="width: 10%;" class="center">{{i+1}}</td>
                                                        <td style="width: 40%;" class="left">{{item.value.name_origin}}</td>
                                                        <td style="width: 10%;" class="left">
                                                            <span *ngIf="item.value.index == 0">ปัจจุบัน</span>
                                                            <span *ngIf="item.value.index != 0">รอบที่ {{item.value.index}}</span>
                                                        </td>
                                                        <td style="width: 10%;" class="left">{{item.value.created_at | date: 'dd/MM/yyyy HH:mm:ss'}}</td>
                                                        <td style="width: 10%;" class="center">
                                                            <a type="button" class="btn btn-rounded btn-info" title="โหลดเอกสาร" target="_blank"
                                                            href="{{ item.value.url }}">
                                                                <i class="fa fas fa-download"></i></a>
                                                            <button type="button" class="btn btn-rounded btn-danger" (click)="deleteFileProcess(item.value.id)">
                                                                <i class="fa fa-minus"></i></button>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>

                                  </div>
                              </div>
                            
                      </div>
                  </div>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="container-fluid" *ngIf="isHr">
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header card-header-cover-table">
                    <div class="row">
                        <div class="col-9">
                            ข้อมูลเอกสารสำคัญ
                        </div>
                        <div class="col-3">
                             
                        </div>
                    </div>
                </div>
                <div class="card-body">
                  <div class="row">
                      <div class="panel-group col-sm-12 col-md-12">
                            
                              <div class="form-group">
                                  <div class="input-group">
                                    <div class="card col-sm-12 col-md-12">
                                        <div class="card-header">รายการเอกสารสำคัญ</div>
                                        <div class="table-responsive">
                                            <table class="table">
                                                <thead>
                                                    <tr>
                                                        <th style="width: 10%;" class="center">ลำดับ</th>
                                                        <th style="width: 40%;">ชื่อไฟล์</th>
                                                        <th style="width: 10%;">วันที่อัพโหลดไฟล์</th>
                                                        <th style="width: 10%;"></th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr *ngFor="let item of fileImportantMap | keyvalue: descOrder; index as i" [ngClass]="{ 'bg-init': item.value.index == 0 , 'bg-palegoldenrod': item.value.index % 2 == 0 }" >
                                                        <td style="width: 10%;" class="center">{{i+1}}</td>
                                                        <td style="width: 40%;" class="left">{{item.value.name_origin}}</td>
                                                        <td style="width: 10%;" class="left">{{item.value.created_at | date: 'dd/MM/yyyy HH:mm:ss'}}</td>
                                                        <td style="width: 10%;" class="center">
                                                            <a type="button" class="btn btn-rounded btn-info" title="โหลดเอกสาร" target="_blank"
                                                            href="{{ item.value.url }}">
                                                                <i class="fa fas fa-download"></i></a>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>

                                  </div>
                              </div>
                            
                      </div>
                  </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header card-header-cover-table">
                    <div class="row">
                        <div class="col-9">
                            ประวัติเข้าออกงาน
                        </div>
                        <div class="col-3" *ngIf="employee?.status != 'A'">
                            <!-- <button type="button" class="btn btn-rounded btn-warning" 
                            (click)="backToWork('O')"><i class="fas fa-sign-in-alt"></i> กลับเข้างานไม่ลบประวัติเข้าออกงาน</button>&nbsp; -->
                            <button type="button" class="btn btn-rounded btn-danger" 
                            (click)="backToWork('D')"><i class="fas fa-sign-in-alt"></i> กลับเข้างานลบประวัติเข้าออกงาน</button>
                        </div>
                    </div>
                </div>
                <div class="card-body">
                    <div class="row" *ngFor="let item of reasonLeaveWorkList; index as i" >
                        <div class="panel-group col-sm-12 col-md-12">
                        <fieldset class="border p-2">
                            <legend  class="w-auto legend-header" style="text-align: left;color: #1ab196;"> ประวัติเข้าออกงานครั้งที่ {{i+1}}</legend>
                            <div class="row" style="padding-left: 2px;padding-right: 2px;">
                                <div class="card col-sm-12 col-md-3">
                                    วันที่จบการอบรม : {{item.start_work | date: 'dd/MM/yyyy'}}
                                </div>
                                <div class="card col-sm-12 col-md-3">
                                    วันที่ออกจากงาน : {{item.leave_work | date: 'dd/MM/yyyy'}}
                                </div>
                                <div class="card col-sm-12 col-md-6">
                                    เหตุผลที่ออกจากงาน : <textarea class="form-control" rows="3" disabled>{{item.reason}}</textarea>
                                </div>
                            </div>
                            <div class="row" style="padding-left: 2px;padding-right: 2px;">
                                <div class="card col-sm-12 col-md-12">
                                    <div class="card-header">รายการหลักฐาน</div>
                                    <div class="table-responsive">
                                        <table id="company_table" class="table table-striped table-bordered">
                                            <thead>
                                                <tr>
                                                    <th style="width: 10%;" class="center">ลำดับ</th>
                                                    <th style="width: 40%;">ชื่อไฟล์</th>
                                                    <th style="width: 10%;">วันที่อัพโหลดไฟล์</th>
                                                    <th style="width: 10%;"></th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr *ngFor="let item of item.fileInfoMap | keyvalue; index as i">
                                                    <td style="width: 10%;" class="center">{{i+1}}</td>
                                                    <td style="width: 40%;" class="left">{{item.value.name_origin}}</td>
                                                    <td style="width: 10%;" class="left">{{item.value.created_at | date: 'dd/MM/yyyy HH:mm:ss'}}</td>
                                                    <td style="width: 10%;" class="center">
                                                        <a type="button" class="btn btn-rounded btn-info" title="โหลดเอกสาร" target="_blank" href="{{ item.value.url }}">
                                                            <i class="fa fas fa-download"></i></a>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </fieldset>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Start Modal exportDocument -->
<!-- <div class="modal" id="modal-export-document" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel1">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-body center remove-modal-bg-content">
                <i class="fa fa-exclamation-circle warnnig-remove-icon" aria-hidden="true"></i><br />
                <span class="warnnig-remove-text">
                    คุณต้องการลบพนักงานนี้
                </span>
            </div>
            <div class="modal-footer center">
                    <button type="button" class="btn btn-danger" (click)="deleteProcess(currentId)">ยืนยัน</button>&nbsp;
                    <button type="button" class="btn btn-light" data-dismiss="modal">ยกเลิก</button>
            </div>
        </div>
    </div>
</div> -->

<div class="modal fade text-left" id="modal-export-document" tabindex="-1" role="dialog" aria-labelledby="myModalLabel17" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header add-modal">
                <h4 class="modal-title" id="myModalLabel17">รายการเอกสาร</h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body"> 
                <div class="table-responsive">
                    <div class="form-group m-b-30">
                        <label for="customer_id">หน่วยงานลูกค้า</label>
                        <select class="form-control" (change)="validateCustomer();getCustomerEmail($event.target.value)"
                        [(ngModel)]="customerId" [ngClass]="{ 'is-invalid': invalid_customer }">
                            <option value="">--- กรุณาเลือก ---</option>
                            <option *ngFor="let item of customerList" value="{{item.id}}">({{item.code}}) {{item.name}}</option>
                        </select>
                        <div *ngIf="invalid_customer" class="text-danger">
                            <div>โปรดระบุหน่วยงานลูกค้า</div>
                        </div>
                    </div>
                    <div class="form-group m-b-30">
                        <label for="customer_email">อีเมล์</label>
                        <div class="form-group">
                            <input type="text" class="form-control" name="customerEmail" [(ngModel)]="customerEmail"
                                [ngClass]="{ 'is-invalid': invalid_customer_email }" />
                        </div>
                        <div *ngIf="invalid_customer_email" class="text-danger">
                            <div>รูปแบบอีเมลล์ไม่ถูกต้อง</div>
                        </div>
                    </div>
                    <table id="company_table" class="table">
                        <thead>
                            <tr>
                                <th style="width: 10%;" class="center">ลำดับ</th>
                                <th style="width: 40%;">ชื่อไฟล์</th>
                                <th style="width: 10%;"></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="width: 10%;" class="center">1</td>
                                <td style="width: 40%;" class="left">ประวัติพนักงาน
                                    <br />
                                    <div class="row">
                                        <div class="col-12">
                                            <label>ชื่อตำแหน่งที่แสดงบนเอกสาร</label>
                                            <div class="form-group">
                                                <input type="text" class="form-control" name="customPosition" [(ngModel)]="customPosition"/>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                                <td style="width: 10%;" class="center">
                                    <input type="checkbox" checked disabled>
                                </td>
                            </tr>
                            <tr *ngFor="let item of fileInfoMap | keyvalue: descOrder; index as i" [ngClass]="{ 'bg-init': item.value.index == 0 , 'bg-palegoldenrod': item.value.index % 2 == 0 }" >
                            <!-- <tr *ngFor="let item of fileInfoMap | keyvalue; index as i"> -->
                                <td style="width: 10%;" class="center">{{i+2}}</td>
                                <td style="width: 40%;" class="left">{{item.value.name_origin}}</td>
                                <td style="width: 10%;" class="center">
                                    <input type="checkbox" [(ngModel)]="item.value.checked">
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-success" (click)="exportDocument()">ตกลง</button>
                <button type="button" class="btn grey btn-danger" data-dismiss="modal">ปิด</button>
            </div>
        </div>
    </div>
</div>
<!-- End Modal exportDocument -->


<div class="modal fade text-left" id="modal-merge-document" tabindex="-1" role="dialog" aria-labelledby="myModalLabel17" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header add-modal">
                <h4 class="modal-title" id="myModalLabel17">รวมเอกสาร</h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body"> 
                <div class="table-responsive">
                    <table id="company_table" class="table">
                        <thead>
                            <tr>
                                <th style="width: 10%;" class="center">ลำดับ</th>
                                <th style="width: 40%;">ชื่อไฟล์</th>
                                <th style="width: 10%;">เอกสารเข้างานรอบที่</th>
                                <th style="width: 10%;"></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="width: 10%;" class="center">1</td>
                                <td style="width: 40%;" class="left">
                                    ประวัติพนักงาน <br />
                                    <div class="row">
                                        <div class="col-12">
                                            <label>ชื่อตำแหน่งที่แสดงบนเอกสาร</label>
                                            <div class="form-group">
                                                <input type="text" class="form-control" name="customPosition" [(ngModel)]="customPosition"/>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                                <td style="width: 10%;" class="center">
                                    <input type="checkbox" (change)="selectDocument(0)">
                                </td>
                            </tr>
                            <tr *ngFor="let item of fileInfoMap | keyvalue: descOrder; index as i" [ngClass]="{ 'bg-init': item.value.index == 0 , 'bg-palegoldenrod': item.value.index % 2 == 0 }" >
                            <!-- <tr *ngFor="let item of fileInfoMap | keyvalue; index as i"> -->
                                <td style="width: 10%;" class="center">{{i+2}}</td>
                                <td style="width: 40%;" class="left">{{item.value.name_origin}}</td>
                                <td style="width: 10%;" class="left">
                                    <span *ngIf="item.value.index == 0">ปัจจุบัน</span>
                                    <span *ngIf="item.value.index != 0">รอบที่ {{item.value.index}}</span>
                                </td>
                                <td style="width: 10%;" class="center">
                                    <input type="checkbox" (change)="selectDocument(item.value.id)">
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-success" (click)="mergeDocument()">ตกลง</button>
                <button type="button" class="btn grey btn-danger" data-dismiss="modal">ปิด</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade text-left" id="modal-export-file" tabindex="-1" role="dialog" aria-labelledby="myModalLabel17" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header add-modal">
                <h4 class="modal-title" id="myModalLabel17">Export เอกสารประวัติ</h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body"> 
                 <div class="row">
                    <div class="col-12">
                        <form>
                            <div class="row">
                                <div class="col-12">
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" id="exportType1" name="exportType" [(ngModel)]="exportType" [value]="true" checked>
                                        <label class="form-check-label" for="exportType1">pdf</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" id="exportType2" name="exportType"  [(ngModel)]="exportType" [value]="false">
                                        <label class="form-check-label" for="exportType2">ms word</label>
                                    </div>
                                </div>
                            </div> 
                            <br />
                            <div class="row">
                                <div class="col-12">
                                    <label>ชื่อตำแหน่งที่แสดงบนเอกสาร</label>
                                    <div class="form-group">
                                        <input type="text" class="form-control" name="customPosition" [(ngModel)]="customPosition"/>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                 </div> 
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-success" (click)="exportProfile()">ตกลง</button>
                <button type="button" class="btn grey btn-danger" data-dismiss="modal">ปิด</button>
            </div>
        </div>
    </div>
</div>  

<div class="modal fade text-left" id="modal-export-employee-card" tabindex="-1" role="dialog" aria-labelledby="myModalLabel17" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header add-modal">
                <h4 class="modal-title" id="myModalLabel17">โหลดบัตรพนักงาน</h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body"> 
                 <div class="row">
                    <div class="col-12">
                        <form>
                            <div class="row">
                                <div class="col-12">
                                    <label>ชื่อตำแหน่งที่แสดงบนบัตร</label>
                                    <div class="form-group">
                                        <input type="text" class="form-control" name="employeePosition" [(ngModel)]="employeePosition"/>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                 </div> 
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-success" (click)="createEmployeeCardReport()">ตกลง</button>
                <button type="button" class="btn grey btn-danger" data-dismiss="modal">ปิด</button>
            </div>
        </div>
    </div>
</div>